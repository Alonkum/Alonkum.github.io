(self.webpackChunkgovmap_angular=self.webpackChunkgovmap_angular||[]).push([[665],{6665:(e,t,i)=>{"use strict";i.r(t),i.d(t,{GovMapModule:()=>L});var a=i(8583),s=i(7716),n=i(3533),o=i(6215),r=i(7574),l=i(9765),g=(i(739),i(3190)),h=(i(5257),i(8002),i(6782));const d=["*"];class p{constructor(e){this._ngZone=e,this._pending=[],this._listeners=[],this._targetStream=new o.X(void 0)}_clearListeners(){for(const e of this._listeners)e.remove();this._listeners=[]}getLazyEmitter(e){return this._targetStream.pipe((0,g.w)(t=>{const i=new r.y(a=>{if(!t)return void this._pending.push({observable:i,observer:a});const s=t.addListener(e,e=>{this._ngZone.run(()=>a.next(e))});return this._listeners.push(s),()=>s.remove()});return i}))}setTarget(e){const t=this._targetStream.value;e!==t&&(t&&(this._clearListeners(),this._pending=[]),this._targetStream.next(e),this._pending.forEach(e=>e.observable.subscribe(e.observer)),this._pending=[])}destroy(){this._clearListeners(),this._pending=[],this._targetStream.complete()}}const u={center:{lat:37.421995,lng:-122.084092},zoom:17,mapTypeId:"roadmap"},c="500px",m="500px";let y=(()=>{class e{constructor(e,t,i){this._elementRef=e,this._ngZone=t,this._eventManager=new p(this._ngZone),this.height=c,this.width=m,this._options=u,this.boundsChanged=this._eventManager.getLazyEmitter("bounds_changed"),this.centerChanged=this._eventManager.getLazyEmitter("center_changed"),this.mapClick=this._eventManager.getLazyEmitter("click"),this.mapDblclick=this._eventManager.getLazyEmitter("dblclick"),this.mapDrag=this._eventManager.getLazyEmitter("drag"),this.mapDragend=this._eventManager.getLazyEmitter("dragend"),this.mapDragstart=this._eventManager.getLazyEmitter("dragstart"),this.headingChanged=this._eventManager.getLazyEmitter("heading_changed"),this.idle=this._eventManager.getLazyEmitter("idle"),this.maptypeidChanged=this._eventManager.getLazyEmitter("maptypeid_changed"),this.mapMousemove=this._eventManager.getLazyEmitter("mousemove"),this.mapMouseout=this._eventManager.getLazyEmitter("mouseout"),this.mapMouseover=this._eventManager.getLazyEmitter("mouseover"),this.projectionChanged=this._eventManager.getLazyEmitter("projection_changed"),this.mapRightclick=this._eventManager.getLazyEmitter("rightclick"),this.tilesloaded=this._eventManager.getLazyEmitter("tilesloaded"),this.tiltChanged=this._eventManager.getLazyEmitter("tilt_changed"),this.zoomChanged=this._eventManager.getLazyEmitter("zoom_changed"),this._isBrowser=(0,a.NF)(i),this._isBrowser&&window}set center(e){this._center=e}set zoom(e){this._zoom=e}set options(e){this._options=e||u}ngOnChanges(e){(e.height||e.width)&&this._setSize();const t=this.googleMap;t&&(e.options&&t.setOptions(this._combineOptions()),e.center&&this._center&&t.setCenter(this._center),e.zoom&&null!=this._zoom&&t.setZoom(this._zoom),e.mapTypeId&&this.mapTypeId&&t.setMapTypeId(this.mapTypeId))}ngOnInit(){this._isBrowser&&(this._mapEl=this._elementRef.nativeElement.querySelector(".map-container"),this._setSize(),this._ngZone.runOutsideAngular(()=>{this.googleMap=new google.maps.Map(this._mapEl,this._combineOptions())}),this._eventManager.setTarget(this.googleMap))}ngOnDestroy(){this._eventManager.destroy()}fitBounds(e,t){this._assertInitialized(),this.googleMap.fitBounds(e,t)}panBy(e,t){this._assertInitialized(),this.googleMap.panBy(e,t)}panTo(e){this._assertInitialized(),this.googleMap.panTo(e)}panToBounds(e,t){this._assertInitialized(),this.googleMap.panToBounds(e,t)}getBounds(){return this._assertInitialized(),this.googleMap.getBounds()||null}getCenter(){return this._assertInitialized(),this.googleMap.getCenter()}getClickableIcons(){return this._assertInitialized(),this.googleMap.getClickableIcons()}getHeading(){return this._assertInitialized(),this.googleMap.getHeading()}getMapTypeId(){return this._assertInitialized(),this.googleMap.getMapTypeId()}getProjection(){return this._assertInitialized(),this.googleMap.getProjection()}getStreetView(){return this._assertInitialized(),this.googleMap.getStreetView()}getTilt(){return this._assertInitialized(),this.googleMap.getTilt()}getZoom(){return this._assertInitialized(),this.googleMap.getZoom()}get controls(){return this._assertInitialized(),this.googleMap.controls}get data(){return this._assertInitialized(),this.googleMap.data}get mapTypes(){return this._assertInitialized(),this.googleMap.mapTypes}get overlayMapTypes(){return this._assertInitialized(),this.googleMap.overlayMapTypes}_setSize(){if(this._mapEl){const e=this._mapEl.style;e.height=null===this.height?"":_(this.height)||c,e.width=null===this.width?"":_(this.width)||m}}_combineOptions(){var e,t;const i=this._options||{};return Object.assign(Object.assign({},i),{center:this._center||i.center||u.center,zoom:null!==(t=null!==(e=this._zoom)&&void 0!==e?e:i.zoom)&&void 0!==t?t:u.zoom,mapTypeId:this.mapTypeId||i.mapTypeId||u.mapTypeId})}_assertInitialized(){}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(s.SBq),s.Y36(s.R0b),s.Y36(s.Lbi))},e.\u0275cmp=s.Xpm({type:e,selectors:[["google-map"]],inputs:{height:"height",width:"width",center:"center",zoom:"zoom",options:"options",mapTypeId:"mapTypeId"},outputs:{boundsChanged:"boundsChanged",centerChanged:"centerChanged",mapClick:"mapClick",mapDblclick:"mapDblclick",mapDrag:"mapDrag",mapDragend:"mapDragend",mapDragstart:"mapDragstart",headingChanged:"headingChanged",idle:"idle",maptypeidChanged:"maptypeidChanged",mapMousemove:"mapMousemove",mapMouseout:"mapMouseout",mapMouseover:"mapMouseover",projectionChanged:"projectionChanged",mapRightclick:"mapRightclick",tilesloaded:"tilesloaded",tiltChanged:"tiltChanged",zoomChanged:"zoomChanged"},exportAs:["googleMap"],features:[s.TTD],ngContentSelectors:d,decls:2,vars:0,consts:[[1,"map-container"]],template:function(e,t){1&e&&(s.F$t(),s._UZ(0,"div",0),s.Hsn(1))},encapsulation:2,changeDetection:0}),e})();const v=/([A-Za-z%]+)$/;function _(e){return null==e?"":v.test(e)?e:`${e}px`}let M=(()=>{class e{constructor(e,t){this._map=e,this._ngZone=t,this._eventManager=new p(this._ngZone),this._opacity=new o.X(1),this._url=new o.X(""),this._bounds=new o.X(void 0),this._destroyed=new l.xQ,this.clickable=!1,this.mapClick=this._eventManager.getLazyEmitter("click"),this.mapDblclick=this._eventManager.getLazyEmitter("dblclick")}set url(e){this._url.next(e)}get bounds(){return this._bounds.value}set bounds(e){this._bounds.next(e)}set opacity(e){this._opacity.next(e)}ngOnInit(){this._map._isBrowser&&(this._bounds.pipe((0,h.R)(this._destroyed)).subscribe(e=>{this.groundOverlay&&(this.groundOverlay.setMap(null),this.groundOverlay=void 0),e&&(this._ngZone.runOutsideAngular(()=>{this.groundOverlay=new google.maps.GroundOverlay(this._url.getValue(),e,{clickable:this.clickable,opacity:this._opacity.value})}),this._assertInitialized(),this.groundOverlay.setMap(this._map.googleMap),this._eventManager.setTarget(this.groundOverlay))}),this._watchForOpacityChanges(),this._watchForUrlChanges())}ngOnDestroy(){this._eventManager.destroy(),this._destroyed.next(),this._destroyed.complete(),this.groundOverlay&&this.groundOverlay.setMap(null)}getBounds(){return this._assertInitialized(),this.groundOverlay.getBounds()}getOpacity(){return this._assertInitialized(),this.groundOverlay.getOpacity()}getUrl(){return this._assertInitialized(),this.groundOverlay.getUrl()}_watchForOpacityChanges(){this._opacity.pipe((0,h.R)(this._destroyed)).subscribe(e=>{null!=e&&(this._assertInitialized(),this.groundOverlay.setOpacity(e))})}_watchForUrlChanges(){this._url.pipe((0,h.R)(this._destroyed)).subscribe(e=>{this._assertInitialized();const t=this.groundOverlay;t.set("url",e),t.setMap(null),t.setMap(this._map.googleMap)})}_assertInitialized(){}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(y),s.Y36(s.R0b))},e.\u0275dir=s.lG2({type:e,selectors:[["map-ground-overlay"]],inputs:{clickable:"clickable",url:"url",bounds:"bounds",opacity:"opacity"},outputs:{mapClick:"mapClick",mapDblclick:"mapDblclick"},exportAs:["mapGroundOverlay"]}),e})(),z=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.oAB({type:e}),e.\u0275inj=s.cJS({}),e})();const b=["googleMap"],I=["googleMapOverlay"];let O=(()=>{class e{constructor(e,t){this.govmap=e,this.cd=t,this.apiLoaded=!1,this.layers={show:[33]},this.dynamicLayers=[],this.zoom=14.5,this.options={mapTypeId:"hybrid",zoomControl:!0,scrollwheel:!0,disableDoubleClickZoom:!0},this.groundOverlayImageUrl="",this.groundOverlayImageBaseUrl="https://ags.govmap.gov.il/proxy/proxy.ashx?http://govmap/arcgis/rest/services/AdditionalData/MapServer/export?",this.imageUrlQueryParams={dpi:96,bboxSR:2039,imageSR:2039,transparent:!0,format:"png32",f:"image",layers:"",dynamicLayers:[],bbox:[174982.23054779443,661832.9385742105,184017.76945220557,665967.0614257895],size:[1366,625]},this.boundsBox={east:10,north:10,south:-10,west:-10},this.imageBounds={north:34,east:32,south:-32,west:-34}}ngOnInit(){this.center={lat:32.06777253678647,lng:34.77784472207902},this.govmap.$layersChange.subscribe(e=>this.changeLayers(e))}ngAfterViewInit(){}moveMap(e){var t,i,a,s;this.previousPoint=this.center,this.center=null!==(s=null===(a=null===(i=null===(t=this.vcRef)||void 0===t?void 0:t.googleMap)||void 0===i?void 0:i.getCenter())||void 0===a?void 0:a.toJSON())&&void 0!==s?s:this.center}move(e){this.display=e.latLng.toJSON()}onIdle(e){var t,i,a,s,n,o,r,l;this.imageBounds={north:null===(i=null===(t=this.vcRef.googleMap)||void 0===t?void 0:t.getBounds())||void 0===i?void 0:i.getNorthEast().toJSON().lat,east:null===(s=null===(a=this.vcRef.googleMap)||void 0===a?void 0:a.getBounds())||void 0===s?void 0:s.getNorthEast().toJSON().lng,south:null===(o=null===(n=this.vcRef.googleMap)||void 0===n?void 0:n.getBounds())||void 0===o?void 0:o.getSouthWest().toJSON().lat,west:null===(l=null===(r=this.vcRef.googleMap)||void 0===r?void 0:r.getBounds())||void 0===l?void 0:l.getSouthWest().toJSON().lng}}changeLayers(e){var t,i,a,s,n;if("add"===e.action){const o={id:null===(t=null==e?void 0:e.layer)||void 0===t?void 0:t.layerID,minScale:null===(i=null==e?void 0:e.layer)||void 0===i?void 0:i.minScale,maxScale:null===(a=null==e?void 0:e.layer)||void 0===a?void 0:a.maxScale,name:null===(s=null==e?void 0:e.layer)||void 0===s?void 0:s.caption,source:{type:"mapLayer",mapLayerId:null===(n=null==e?void 0:e.layer)||void 0===n?void 0:n.layerID}};this.imageUrlQueryParams.dynamicLayers.push(o)}else"remove"===e.action&&(this.imageUrlQueryParams.dynamicLayers=this.imageUrlQueryParams.dynamicLayers.filter(t=>{var i;return(null==t?void 0:t.id)!==(null===(i=e.layer)||void 0===i?void 0:i.layerID)}));const o=Object.values(this.imageUrlQueryParams.dynamicLayers).map(e=>e.id);this.imageUrlQueryParams.layers="show:"+o.toString(),this.imageUrlQueryParams.dynamicLayers=JSON.stringify(this.imageUrlQueryParams.dynamicLayers);const r=new URLSearchParams(this.imageUrlQueryParams).toString();this.imageUrlQueryParams.dynamicLayers=JSON.parse(this.imageUrlQueryParams.dynamicLayers),this.groundOverlayImageUrl=this.groundOverlayImageBaseUrl+r}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(n.u),s.Y36(s.sBO))},e.\u0275cmp=s.Xpm({type:e,selectors:[["app-govmap"]],viewQuery:function(e,t){if(1&e&&(s.Gf(b,5),s.Gf(I,5)),2&e){let e;s.iGM(e=s.CRH())&&(t.vcRef=e.first),s.iGM(e=s.CRH())&&(t.googleMapOverlay=e.first)}},inputs:{changeLayer:"changeLayer"},decls:4,vars:5,consts:[["height","780px","width","100%",3,"zoom","center","options","idle","zoomChanged","mapMousemove","mapDragend"],["googleMap",""],[3,"url","bounds"],["googleMapOverlay",""]],template:function(e,t){1&e&&(s.TgZ(0,"google-map",0,1),s.NdJ("idle",function(e){return t.onIdle(e)})("zoomChanged",function(){return t.moveMap(null)})("mapMousemove",function(e){return t.move(e)})("mapDragend",function(){return t.moveMap(null)}),s._UZ(2,"map-ground-overlay",2,3),s.qZA()),2&e&&(s.Q6J("zoom",t.zoom)("center",t.center)("options",t.options),s.xp6(2),s.Q6J("url",t.groundOverlayImageUrl)("bounds",t.imageBounds))},directives:[y,M],styles:[""]}),e})();var C=i(9763),f=i(1841);const w=[{path:"",component:O}];let L=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.oAB({type:e}),e.\u0275inj=s.cJS({imports:[[a.ez,C.Bz.forChild(w),z,f.JF]]}),e})()}}]);